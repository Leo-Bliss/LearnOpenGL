#  深度测试

## 深度测试时机

+ 不基于硬件手段： 片段着色器运行之后（也在模板测试之后）
+ 基于硬件: 目前大部分GPU也有基于硬件的提前深度测试，可在片段着色器运行之前执行。但是有一个前提是不能深度写入。

## 深度测试操作接口

+ 开启：```glEnable(GL_DEPTH_TEST)```
+ 禁用深度写入： `glDepthMask(GL_FALSE)`
+ 修改深度测试函数： `glDepthFunc(GL_LESS)`, 
  + 其他运算符：`GL_ALWAYS`,`GL_NEVER`,`GL_EQUAL`,`GL_LEQUAL`,`GL_GREATER`,`GL_NOTEQUAL`,`GL_GEQUAL`

## 可视化深度

+ 深度信息存储在`gl_FragCoord`向量中，所以查看深度信息可在片段着色器中写类似如下代码：

  ```cpp
  FragColor = vec4(vec3(gl_FragCoord.z), 1);
  ```

## 如何解决/缓解深度冲突？？

+ 手动调偏移使得两个物体不重叠
+ 近平面设置的远一些
+ 提高深度值精度